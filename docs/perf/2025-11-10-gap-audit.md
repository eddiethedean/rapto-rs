# Gap Audit — 2025-11-10

## Reducers
- `rust/src/reduce/tiled.rs` handles both global and axis reducers.
- Float32 global reducers still rely on f64 accumulators; axis reducers fall back to sequential tiled loops without dedicated column kernels.
- Parallel path engages when `rows >= spec.row_block * 2`, leading to Rayon overhead for 512²/1024² shapes.

## SIMD Kernels
- `rust/src/simd/mod.rs` exposes lane-specific AVX2/AVX-512/NEON helpers.
- No dedicated column kernels for float32 axis-0; broadcast and scale share generic helpers lacking prefetch/unroll variants.

## Benchmarks
- Regenerated 2-D suite with `.venv/bin/python` and `RAPTORS_THREADS=8`: SIMD results in `benchmarks/results/latest_simd.json`, scalar control in `benchmarks/results/latest_scalar.json`.
- Captured axis-0 specific numbers via `benchmarks/run_axis0_suite.py --output-json benchmarks/results/latest_axis0.json` (SIMD forced).
- Float32 gaps narrowed: `mean_axis0` now reaches 1.47× at 512², ~1.06× at 1024², and 0.94× at 2048²; column broadcast climbs from ~0.8× at 512² to ≈1.4× at 1024² and ≈1.1× at 2048²; scale holds ≥1.0× through 2048².
- Float64 axis-0 sits near parity for 512²/1024² (0.97×–0.95×) and edges ahead at 2048² (≈1.05×); remaining deltas stem from sequential fallback heuristics.
- Global reducers stay healthy (≥1.8× for float32, ≥1.1× for float64), so roadmap work can focus on column kernels, broadcast scheduling, and scale heuristics.


